<?xml version='1.0'?>
<sdf version='1.7'>
  <model name='Vulcan_G401'>
    <link name='base_link'>
      <self_collide>0</self_collide>
      <enable_wind>0</enable_wind>
      <kinematic>0</kinematic>
      <pose>0 0 0 0 -0 0</pose>
      <mass>1.5</mass>
      <visual name='visual'>
        <geometry>
          <mesh>
            <uri>model://Vulcan_G401/assembly.stl</uri>
            <scale>0.001 0.001 0.001</scale>
            <pose>0 0 0 0 0 0</pose>
          </mesh>
        </geometry>
        <material>
          <script>
            <uri>file://media/materials/scripts/gazebo.material</uri>
            <name>Gazebo/Black</name>
          </script>
          <lighting>1</lighting>
          <ambient>0.01 0.01 0.01 1</ambient>
          <diffuse>0 0 0 1</diffuse>
          <specular>0 0 0 1</specular>
          <emissive>0 0 0 1</emissive>
          <shader type='pixel'/>
        </material>
        <pose>0 0 0 0 -0 0</pose>
        <transparency>0</transparency>
        <cast_shadows>1</cast_shadows>
      </visual>
      <collision name="collision">
        <geometry>
          <mesh>
            <uri>model://Vulcan_G401/assembly.stl</uri>
            <scale>0.001 0.001 0.001</scale>
            <pose>0 0 0 0 0 0</pose>
          </mesh>
        </geometry>
        <surface>
          <contact>
            <collide_bitmask>1</collide_bitmask>
            <ode>
              <friction_coefficient>1</friction_coefficient>
              <bounce>0</bounce>
              <bounce_threshold>1000000</bounce_threshold>
              <soft_cfm>0.0</soft_cfm>
              <soft_erp>0.2</soft_erp>
            </ode>
          </contact>
          <max_vel>100.0</max_vel>
          <min_depth>0.001</min_depth>
        </surface>
      </collision>
    </link>
    <link name='camera_link'>
      <self_collide>0</self_collide>
      <enable_wind>0</enable_wind>
      <kinematic>0</kinematic>
      <pose>-0.086826 -0.079217 0.210503 0 -0 0</pose>
      <visual name='visual'>
        <geometry>
          <mesh>
            <uri>model://Vulcan_G401/zed2.stl</uri>
            <scale>0.00085 0.00085 0.00085</scale>
          </mesh>
        </geometry>
        <material>
          <script>
            <uri>file://media/materials/scripts/gazebo.material</uri>
            <name>Gazebo/White</name>
          </script>
          <shader type='pixel'/>
        </material>
        <pose>0 0 0 0 -0 0</pose>
        <transparency>0</transparency>
        <cast_shadows>1</cast_shadows>
      </visual>
      <collision name="collision">
        <geometry>
          <mesh>
            <uri>model://Vulcan_G401/zed2.stl</uri>
            <scale>0.00085 0.00085 0.00085</scale>
            <pose>-0.086826 -0.079217 0.210503 0 -0 0</pose>
          </mesh>
        </geometry>
        <surface>
          <contact>
            <collide_bitmask>1</collide_bitmask>
            <ode>
              <friction_coefficient>1</friction_coefficient>
              <bounce>0</bounce>
              <bounce_threshold>1000000</bounce_threshold>
              <soft_cfm>0.0</soft_cfm>
              <soft_erp>0.2</soft_erp>
            </ode>
          </contact>
          <max_vel>100.0</max_vel>
          <min_depth>0.001</min_depth>
        </surface>
      </collision>
      <sensor name="zed2" type="depth">
        <camera name="zed2">
          <pose>0.075 -0.085 0 0 0 -1.5708</pose>
          <horizontal_fov>1.047</horizontal_fov>
          <image>
            <width>640</width>
            <height>480</height>
            <format>R8G8B8</format>
          </image>
          <clip>
            <near>0.1</near>
            <far>1000</far>
          </clip>
          <noise>
            <type>gaussian</type>
            <mean>0</mean>
            <stddev>0.007</stddev>
          </noise>
        </camera>
        <plugin name="depth_camera_plugin" filename="libgazebo_ros_depth_camera.so">
          <alwaysOn>true</alwaysOn>
          <updateRate>0.0</updateRate>
          <cameraName>zed2</cameraName>
          <frameName>camera_link</frameName>
          <imageTopicName>zed2/image_2d</imageTopicName>
	  <cameraInfoTopicName>zed2/camera_info</cameraInfoTopicName>
          <pointCloudTopicName>zed2/pointcloud</pointCloudTopicName>
          <pointCloudCutoff>0.5</pointCloudCutoff>
          <clip>
            <near>0.1</near>
            <far>100</far>
          </clip>
        </plugin>
      </sensor>

    </link>
    <link name='lidar_link'>
      <self_collide>0</self_collide>
      <enable_wind>0</enable_wind>
      <kinematic>0</kinematic>
      <pose>-0.003025 -0.010156 0.17778 1.58488 -0 0</pose>
      <visual name='visual'>
        <geometry>
          <mesh>
            <uri>model://Vulcan_G401/rs_lidar.stl</uri>
            <scale>0.0005 0.0005 0.0005</scale>
            <pose>1 1 1 0 0 0</pose>
          </mesh>
        </geometry>
        <material>
          <script>
            <uri>file://media/materials/scripts/gazebo.material</uri>
            <name>Gazebo/Blue</name>
          </script>
          <shader type='pixel'/>
        </material>
        <pose>0 0 0 0 -0 0</pose>
        <transparency>0</transparency>
        <cast_shadows>1</cast_shadows>
      </visual>
      <collision name="collision">
        <geometry>
          <mesh>
            <uri>model://Vulcan_G401/rs_lidar.stl</uri>
            <scale>0.0005 0.0005 0.0005</scale>
            <pose>-0.003025 -0.010156 0.17778 1.58488 -0 0</pose>
          </mesh>
        </geometry>
        <surface>
          <contact>
            <collide_bitmask>1</collide_bitmask>
            <ode>
              <friction_coefficient>1</friction_coefficient>
              <bounce>0</bounce>
              <bounce_threshold>1000000</bounce_threshold>
              <soft_cfm>0.0</soft_cfm>
              <soft_erp>0.2</soft_erp>
            </ode>
          </contact>
          <max_vel>100.0</max_vel>
          <min_depth>0.001</min_depth>
        </surface>
      </collision>
    </link>
    <static>0</static>
    <allow_auto_disable>1</allow_auto_disable>
    <joint name="joint_base_camera" type="fixed">
      <parent>base_link</parent>
      <child>camera_link</child>
      <axis>
        <xyz>0 0 0</xyz>
      </axis>
      <pose>0 0 0 0 0 0</pose>
    </joint>
    <joint name="joint_base_lidar" type="fixed">
      <parent>base_link</parent>
      <child>lidar_link</child>
      <axis>
        <xyz>0 0 0</xyz>
      </axis>
      <pose>0 0 0 0 0 0</pose>
    </joint>

    <include>
      <uri>model://gps</uri>
      <pose>0.1 0 0 0 0 0</pose>
      <name>gps0</name>
    </include>
    <joint name='gps0_joint' type='fixed'>
      <child>gps0::link</child>
      <parent>base_link</parent>
    </joint>
    <include>
      <uri>model://magnetometer</uri>
      <pose>0 0 0 0 0 0</pose>
      <name>mag</name>
    </include>
    <joint name='mag_joint' type='fixed'>
      <child>mag::link</child>
      <parent>base_link</parent>
    </joint>

    <include>
      <uri>model://imu</uri>
      <pose>0 0 0 0 0 0</pose>
      <name>imu</name>
    </include>
    <joint name='imu_joint' type='revolute'>
      <child>imu::link</child>
      <parent>base_link</parent>
      <axis>
        <xyz>1 0 0</xyz>
        <limit>
          <lower>0</lower>
          <upper>0</upper>
          <effort>0</effort>
          <velocity>0</velocity>
        </limit>
        <dynamics>
          <spring_reference>0</spring_reference>
          <spring_stiffness>0</spring_stiffness>
        </dynamics>
        <use_parent_model_frame>1</use_parent_model_frame>
      </axis>
    </joint>

    <plugin name='groundtruth_plugin' filename='libgazebo_groundtruth_plugin.so'>
      <robotNamespace/>
    </plugin>
    <plugin name='barometer_plugin' filename='libgazebo_barometer_plugin.so'>
      <robotNamespace/>
      <pubRate>50</pubRate>
      <baroTopic>/baro</baroTopic>
      <baroDriftPaPerSec>0</baroDriftPaPerSec>
    </plugin>
    <plugin name='mavlink_interface' filename='libgazebo_mavlink_interface.so'>
      <robotNamespace/>
      <imuSubTopic>/imu</imuSubTopic>
      <magSubTopic>/mag</magSubTopic>
      <baroSubTopic>/baro</baroSubTopic>
      <mavlink_addr>INADDR_ANY</mavlink_addr>
      <mavlink_tcp_port>{{ mavlink_tcp_port }}</mavlink_tcp_port>
      <mavlink_udp_port>{{ mavlink_udp_port }}</mavlink_udp_port>
      <serialEnabled>{{ serial_enabled }}</serialEnabled>
      <serialDevice>{{ serial_device }}</serialDevice>
      <baudRate>{{ serial_baudrate }}</baudRate>
      <qgc_addr>INADDR_ANY</qgc_addr>
      <qgc_udp_port>14550</qgc_udp_port>
      <sdk_addr>INADDR_ANY</sdk_addr>
      <sdk_udp_port>14540</sdk_udp_port>
      <hil_mode>{{ hil_mode }}</hil_mode>
      <hil_state_level>0</hil_state_level>
      <send_vision_estimation>0</send_vision_estimation>
      <send_odometry>1</send_odometry>
      <enable_lockstep>1</enable_lockstep>
      <use_tcp>1</use_tcp>
      <motorSpeedCommandPubTopic>/gazebo/command/motor_speed</motorSpeedCommandPubTopic>
      <control_channels>
        <channel name='rotor1'>
          <input_index>0</input_index>
          <input_offset>0</input_offset>
          <input_scaling>1000</input_scaling>
          <zero_position_disarmed>0</zero_position_disarmed>
          <zero_position_armed>100</zero_position_armed>
          <joint_control_type>velocity</joint_control_type>
        </channel>
        <channel name='rotor2'>
          <input_index>1</input_index>
          <input_offset>0</input_offset>
          <input_scaling>1000</input_scaling>
          <zero_position_disarmed>0</zero_position_disarmed>
          <zero_position_armed>100</zero_position_armed>
          <joint_control_type>velocity</joint_control_type>
        </channel>
        <channel name='rotor3'>
          <input_index>2</input_index>
          <input_offset>0</input_offset>
          <input_scaling>1000</input_scaling>
          <zero_position_disarmed>0</zero_position_disarmed>
          <zero_position_armed>100</zero_position_armed>
          <joint_control_type>velocity</joint_control_type>
        </channel>
        <channel name='rotor4'>
          <input_index>3</input_index>
          <input_offset>0</input_offset>
          <input_scaling>1000</input_scaling>
          <zero_position_disarmed>0</zero_position_disarmed>
          <zero_position_armed>100</zero_position_armed>
          <joint_control_type>velocity</joint_control_type>
        </channel>
        <channel name='rotor5'>
          <input_index>4</input_index>
          <input_offset>1</input_offset>
          <input_scaling>324.6</input_scaling>
          <zero_position_disarmed>0</zero_position_disarmed>
          <zero_position_armed>0</zero_position_armed>
          <joint_control_type>velocity</joint_control_type>
          <joint_control_pid>
            <p>0.1</p>
            <i>0</i>
            <d>0</d>
            <iMax>0.0</iMax>
            <iMin>0.0</iMin>
            <cmdMax>2</cmdMax>
            <cmdMin>-2</cmdMin>
          </joint_control_pid>
          <joint_name>zephyr_delta_wing::propeller_joint</joint_name>
        </channel>
        <channel name='rotor6'>
          <input_index>5</input_index>
          <input_offset>0</input_offset>
          <input_scaling>0.524</input_scaling>
          <zero_position_disarmed>0</zero_position_disarmed>
          <zero_position_armed>0</zero_position_armed>
          <joint_control_type>position</joint_control_type>
          <joint_name>zephyr_delta_wing::flap_left_joint</joint_name>
          <joint_control_pid>
            <p>10.0</p>
            <i>0</i>
            <d>0</d>
            <iMax>0</iMax>
            <iMin>0</iMin>
            <cmdMax>20</cmdMax>
            <cmdMin>-20</cmdMin>
          </joint_control_pid>
        </channel>
        <channel name='rotor7'>
          <input_index>6</input_index>
          <input_offset>0</input_offset>
          <input_scaling>0.524</input_scaling>
          <zero_position_disarmed>0</zero_position_disarmed>
          <zero_position_armed>0</zero_position_armed>
          <joint_control_type>position</joint_control_type>
          <joint_name>zephyr_delta_wing::flap_right_joint</joint_name>
          <joint_control_pid>
            <p>10.0</p>
            <i>0</i>
            <d>0</d>
            <iMax>0</iMax>
            <iMin>0</iMin>
            <cmdMax>20</cmdMax>
            <cmdMin>-20</cmdMin>
          </joint_control_pid>
        </channel>
        <channel name='rotor8'>
          <input_index>7</input_index>
          <input_offset>0</input_offset>
          <input_scaling>0.524</input_scaling>
          <zero_position_disarmed>0</zero_position_disarmed>
          <zero_position_armed>0</zero_position_armed>
          <joint_control_type>position</joint_control_type>
        </channel>
      </control_channels>
    </plugin>

  </model>
</sdf>
